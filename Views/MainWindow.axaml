<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:NetKeyer.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="600" d:DesignHeight="500"
        x:Class="NetKeyer.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="NetKeyer - FlexRadio CW Keyer"
        Width="700" Height="700"
        MinWidth="600" MinHeight="600">

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <ScrollViewer>
        <StackPanel Margin="20" Spacing="15">

            <!-- Header -->
            <TextBlock Text="FlexRadio CW Keyer"
                       FontSize="24" FontWeight="Bold"
                       HorizontalAlignment="Center"/>

            <!-- Radio Discovery Section -->
            <Border BorderBrush="Gray" BorderThickness="1" Padding="15" CornerRadius="5">
                <StackPanel Spacing="10">
                    <TextBlock Text="Radio Selection" FontWeight="Bold" FontSize="16"/>

                    <StackPanel Orientation="Horizontal" Spacing="10">
                        <TextBlock Text="Radio + Client:" VerticalAlignment="Center" Width="100"/>
                        <ComboBox Name="RadioComboBox"
                                  ItemsSource="{Binding RadioClientSelections}"
                                  SelectedItem="{Binding SelectedRadioClient}"
                                  Width="400"
                                  PlaceholderText="Select a radio and GUI client..."/>
                        <Button Content="Refresh"
                                Command="{Binding RefreshRadiosCommand}"
                                Width="80"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Spacing="10">
                        <TextBlock Text="Status:" VerticalAlignment="Center" Width="100"/>
                        <TextBlock Text="{Binding RadioStatus}"
                                   VerticalAlignment="Center"
                                   Foreground="{Binding RadioStatusColor}"/>
                    </StackPanel>

                    <Button Content="{Binding ConnectButtonText}"
                            Command="{Binding ToggleConnectionCommand}"
                            HorizontalAlignment="Left"
                            Width="120"/>
                </StackPanel>
            </Border>

            <!-- Serial Port Section -->
            <Border BorderBrush="Gray" BorderThickness="1" Padding="15" CornerRadius="5">
                <StackPanel Spacing="10">
                    <TextBlock Text="Serial Port Selection" FontWeight="Bold" FontSize="16"/>

                    <StackPanel Orientation="Horizontal" Spacing="10">
                        <TextBlock Text="HaliKey Version:" VerticalAlignment="Center" Width="100"/>
                        <ComboBox ItemsSource="{Binding HaliKeyVersions}"
                                  SelectedItem="{Binding SelectedHaliKeyVersion}"
                                  Width="200"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Spacing="10">
                        <TextBlock Text="Port:" VerticalAlignment="Center" Width="100"/>
                        <ComboBox Name="SerialPortComboBox"
                                  ItemsSource="{Binding SerialPorts}"
                                  SelectedItem="{Binding SelectedSerialPort}"
                                  Width="200"
                                  PlaceholderText="Select a port..."/>
                        <Button Content="Refresh"
                                Command="{Binding RefreshSerialPortsCommand}"
                                Width="80"/>
                    </StackPanel>

                    <!-- Serial Line Status Indicators -->
                    <TextBlock Text="Serial Line Status:" FontWeight="SemiBold" Margin="0,10,0,0"/>
                    <StackPanel Orientation="Horizontal" Spacing="20">
                        <!-- Left Paddle Indicator -->
                        <StackPanel Spacing="5">
                            <StackPanel Orientation="Horizontal" Spacing="5">
                                <TextBlock Text="{Binding LeftPaddlePinName}" FontSize="12" FontWeight="Bold"/>
                                <TextBlock Text="(Left Paddle)" FontSize="12"/>
                            </StackPanel>
                            <Border Width="80" Height="40"
                                    Background="{Binding LeftPaddleIndicatorColor}"
                                    BorderBrush="DarkGray"
                                    BorderThickness="2"
                                    CornerRadius="3">
                                <TextBlock Text="{Binding LeftPaddleStateText}"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           Foreground="White"
                                           FontWeight="Bold"/>
                            </Border>
                        </StackPanel>

                        <!-- Right Paddle Indicator -->
                        <StackPanel Spacing="5">
                            <StackPanel Orientation="Horizontal" Spacing="5">
                                <TextBlock Text="{Binding RightPaddlePinName}" FontSize="12" FontWeight="Bold"/>
                                <TextBlock Text="(Right Paddle)" FontSize="12"/>
                            </StackPanel>
                            <Border Width="80" Height="40"
                                    Background="{Binding RightPaddleIndicatorColor}"
                                    BorderBrush="DarkGray"
                                    BorderThickness="2"
                                    CornerRadius="3">
                                <TextBlock Text="{Binding RightPaddleStateText}"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           Foreground="White"
                                           FontWeight="Bold"/>
                            </Border>
                        </StackPanel>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- MIDI Device Section -->
            <Border BorderBrush="Gray" BorderThickness="1" Padding="15" CornerRadius="5">
                <StackPanel Spacing="10">
                    <TextBlock Text="MIDI Device Selection" FontWeight="Bold" FontSize="16"/>

                    <StackPanel Orientation="Horizontal" Spacing="10">
                        <TextBlock Text="MIDI Device:" VerticalAlignment="Center" Width="100"/>
                        <ComboBox Name="MidiDeviceComboBox"
                                  ItemsSource="{Binding MidiDevices}"
                                  SelectedItem="{Binding SelectedMidiDevice}"
                                  Width="300"
                                  PlaceholderText="Select a MIDI device..."/>
                        <Button Content="Refresh"
                                Command="{Binding RefreshMidiDevicesCommand}"
                                Width="80"/>
                    </StackPanel>

                    <TextBlock Text="Note: MIDI uses Note 20 (Left Paddle) and Note 21 (Right Paddle)"
                               FontSize="11"
                               Foreground="Gray"/>
                </StackPanel>
            </Border>

            <!-- CW Settings Section -->
            <Border BorderBrush="Gray" BorderThickness="1" Padding="15" CornerRadius="5">
                <StackPanel Spacing="10">
                    <TextBlock Text="CW Settings" FontWeight="Bold" FontSize="16"/>

                    <!-- Speed -->
                    <StackPanel Spacing="5">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <TextBlock Text="Speed (WPM):" Width="120"/>
                            <TextBlock Text="{Binding CwSpeed}" Width="40"/>
                        </StackPanel>
                        <Slider Minimum="5" Maximum="60"
                                Value="{Binding CwSpeed}"
                                TickFrequency="5"
                                Width="400"
                                HorizontalAlignment="Left"/>
                    </StackPanel>

                    <!-- Sidetone Volume -->
                    <StackPanel Spacing="5">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <TextBlock Text="Sidetone Volume:" Width="120"/>
                            <TextBlock Text="{Binding SidetoneVolume}" Width="40"/>
                        </StackPanel>
                        <Slider Minimum="0" Maximum="100"
                                Value="{Binding SidetoneVolume}"
                                TickFrequency="10"
                                Width="400"
                                HorizontalAlignment="Left"/>
                    </StackPanel>

                    <!-- Pitch -->
                    <StackPanel Spacing="5">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <TextBlock Text="Pitch (Hz):" Width="120"/>
                            <TextBlock Text="{Binding CwPitch}" Width="40"/>
                        </StackPanel>
                        <Slider Minimum="300" Maximum="1000"
                                Value="{Binding CwPitch}"
                                TickFrequency="50"
                                Width="400"
                                HorizontalAlignment="Left"/>
                    </StackPanel>

                    <!-- Mode Selection -->
                    <StackPanel Spacing="5">
                        <TextBlock Text="Keyer Mode:"/>
                        <StackPanel Orientation="Horizontal" Spacing="20">
                            <RadioButton Content="Iambic"
                                         GroupName="KeyerMode"
                                         IsChecked="{Binding IsIambicMode}"/>
                            <RadioButton Content="Straight Key"
                                         GroupName="KeyerMode"
                                         IsChecked="{Binding !IsIambicMode}"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Iambic Mode Selection (A vs B) -->
                    <StackPanel Spacing="5">
                        <TextBlock Text="Iambic Type:"/>
                        <StackPanel Orientation="Horizontal" Spacing="20">
                            <RadioButton Content="Mode A"
                                         GroupName="IambicType"
                                         IsChecked="{Binding !IsIambicModeB}"
                                         IsEnabled="{Binding IsIambicMode}"/>
                            <RadioButton Content="Mode B"
                                         GroupName="IambicType"
                                         IsChecked="{Binding IsIambicModeB}"
                                         IsEnabled="{Binding IsIambicMode}"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Swap Paddles -->
                    <StackPanel Spacing="5">
                        <CheckBox Content="Swap Paddles (Left â†” Right)"
                                  IsChecked="{Binding SwapPaddles}"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Exit Button -->
            <Button Content="Exit"
                    Command="{Binding ExitCommand}"
                    HorizontalAlignment="Center"
                    Width="120"
                    Margin="0,10,0,0"/>

        </StackPanel>
    </ScrollViewer>

</Window>
